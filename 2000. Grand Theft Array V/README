чтобы не закопаться в if, использовал префиксные суммы
